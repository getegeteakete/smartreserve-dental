# 予約受付時間設定 - テストガイド

## ✅ 実装した機能

### 1. **受付可否トグルボタン**
   - **緑色ボタン（受付可能）**: クリックで受付不可に切り替え
   - **グレーボタン（受付不可）**: クリックで受付可能に切り替え
   - アイコンが変化（ToggleRight ⇔ ToggleLeft）

### 2. **削除ボタン**
   - 赤い削除ボタンで設定を削除
   - 確認ダイアログが表示されます
   - 削除後、リストから消えます

### 3. **バー表示機能**
   - 各曜日の上部に緑色のバーで時間帯を表示
   - 複数の時間帯が縦に並んで表示
   - バー間の空白 = 休憩時間

### 4. **複数時間帯の追加**
   - 「時間帯を追加」ボタンで即座に追加
   - 午前（10:00-13:00）、午後（15:00-19:00）など
   - 最大3つまで追加可能

---

## 🧪 テスト手順

### テスト1: データベースセットアップ

1. **Supabaseにアクセス**
   - https://app.supabase.com
   
2. **SQL Editorを開く**
   - 左メニューから「SQL Editor」
   
3. **セットアップSQLを実行**
   ```sql
   -- test-booking-time-schedules.sql の内容をコピペして実行
   ```
   
4. **確認**
   ```sql
   SELECT COUNT(*) FROM public.booking_time_schedules;
   ```
   結果: 10件以上のデータが表示されればOK

---

### テスト2: 受付可否トグル機能

http://localhost:8080/admin/schedule の「予約受付時間設定」タブで：

#### ステップ1: 受付可能 → 受付不可
1. 緑色の **「受付可能」** ボタンをクリック
2. **期待結果**:
   - ボタンがグレーに変化
   - 「受付不可」に表示が変わる
   - トーストで「受付停止にしました」と表示
   - 上部のバーがグレーに変化

#### ステップ2: 受付不可 → 受付可能
1. グレーの **「受付不可」** ボタンをクリック
2. **期待結果**:
   - ボタンが緑色に変化
   - 「受付可能」に表示が変わる
   - トーストで「受付可能にしました」と表示
   - 上部のバーが緑色に変化

---

### テスト3: 削除機能

#### ステップ1: 削除実行
1. 赤い **「削除」** ボタンをクリック
2. 確認ダイアログが表示
3. **「OK」** をクリック

#### 期待結果:
- トーストで「削除しました」と表示
- 設定がリストから消える
- 上部のバーからも消える
- 曜日の「件数」が減る

---

### テスト4: 複数時間帯（休憩時間）の設定

#### ステップ1: 午前の時間帯を追加
1. 月曜日の **「月曜日に時間帯を追加」** をクリック
2. **期待結果**:
   - 10:00-13:00の緑バーが表示
   - 時間帯1が追加される

#### ステップ2: 午後の時間帯を追加
1. **「午後の時間帯を追加（例：15:00-19:00）」** をクリック
2. **期待結果**:
   - 15:00-19:00の緑バーが追加
   - 上部に2つの緑バーが表示
   - **13:00-15:00が空白**（休憩時間）

#### ステップ3: バーの視覚確認
- 上部の全体バーを確認
- 2つの緑バーが縦に並んでいる
- 間に空白があれば成功（休憩時間）

---

### テスト5: バーのドラッグ編集

#### ステップ1: 編集モードに入る
1. 設定の **「編集」** ボタンをクリック
2. 青いバーが表示される

#### ステップ2: バーをドラッグ
1. バーの**左端**をドラッグ → 開始時間が変わる
2. バーの**右端**をドラッグ → 終了時間が変わる
3. **期待結果**:
   - リアルタイムで時間が更新
   - 15分単位で調整される
   - 下部に時間の詳細が表示

#### ステップ3: 保存
1. **「保存」** ボタンをクリック
2. **期待結果**:
   - トーストで「予約受付時間更新完了」
   - バーが新しい時間で固定される

---

## 📊 チェックリスト

- [ ] データベースにテーブルが作成されている
- [ ] サンプルデータが挿入されている
- [ ] ページが正常に表示される
- [ ] 受付可能→受付不可のトグルが動作
- [ ] 受付不可→受付可能のトグルが動作
- [ ] 削除ボタンで設定が削除される
- [ ] 時間帯追加ボタンで新しい時間帯が追加
- [ ] バーが正しく表示される
- [ ] バーのドラッグで時間が変更できる
- [ ] 保存後、変更が反映される

---

## 🎯 成功の確認

すべてのテストが成功すると：

1. ✅ 各曜日に複数の時間帯を設定可能
2. ✅ 休憩時間を挟んだ設定ができる
3. ✅ ワンクリックで受付可否を切り替え
4. ✅ 不要な設定を削除できる
5. ✅ 視覚的なバー表示で分かりやすい
6. ✅ ドラッグで直感的に時間を調整

---

## 🐛 エラーが出た場合

### エラーメッセージを確認

1. ブラウザで **F12** キーを押す
2. **Console** タブを確認
3. エラーメッセージをコピー

### よくあるエラー

#### "relation public.booking_time_schedules does not exist"
→ `test-booking-time-schedules.sql` を実行してください

#### "予約受付時間設定エラー"
→ Supabaseの接続を確認してください

#### バーが表示されない
→ データがありません。「時間帯を追加」ボタンで追加してください

---

## 📞 完成した機能

### http://localhost:8080/admin/schedule で確認できること：

1. **視覚的なバー表示** - 緑色のバーで時間帯を表示
2. **ドラッグ編集** - バーをドラッグして時間を調整
3. **ワンクリックトグル** - 受付可能⇔受付不可を切り替え
4. **簡単削除** - 赤いボタンで削除
5. **複数時間帯** - 休憩時間を含む柔軟な設定
6. **リアルタイム更新** - 変更がすぐに反映

すべて実装済みです！🎉


