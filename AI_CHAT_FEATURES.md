# 🤖 AIチャット機能 - SmartReserve予約システム

## 📋 概要

SmartReserve予約システムにAIチャット機能を実装しました。自然言語での予約作成、治療相談、スタッフとの接続が可能です。

## 🎯 実装済み機能

### 1. **AIチャットボット**
- 右下に表示されるチャットボタン
- 自然言語での予約作成
- 治療内容の相談
- スタッフとの接続

### 2. **自然言語予約解析**
- 日付の抽出: 「12月25日」「明日」「来週」
- 時間の抽出: 「14:30」「午後2時」「夕方」
- 治療内容の抽出: 「虫歯治療」「定期検診」
- 患者情報の抽出: 名前、電話番号、メールアドレス

### 3. **スタッフ接続機能**
- オンライン・対応中・オフラインの表示
- 専門分野の表示
- 評価・対応可能時間の表示
- チャットまたは電話での接続

### 4. **予約システム統合**
- AIが抽出したデータを予約フォームに自動入力
- 既存の予約フローとの完全統合

## 🚀 使用方法

### **自然言語予約の例**
```
ユーザー: 「12月25日14時に虫歯治療の予約を取りたいです」
AI: 予約のお手伝いをさせていただきます！
    📅 12月25日 🕐 14:00 🦷 虫歯治療
    こちらの内容で予約を進めますか？
```

### **相談の例**
```
ユーザー: 「歯が痛いのですが、どうしたらいいですか？」
AI: お悩みをお聞かせください。
    スタッフが直接お答えいたします。どの方法がご希望ですか？
```

### **スタッフ接続の例**
```
ユーザー: 「スタッフと話したいです」
AI: スタッフとの接続をご希望ですね。
    チャットまたはお電話でお繋ぎします。どちらがご希望ですか？
```

## 🛠️ 技術実装

### **コンポーネント構成**
- `AIChatBot.tsx`: メインのチャットインターフェース
- `StaffConnectionDialog.tsx`: スタッフ選択・接続ダイアログ
- `aiBookingParser.ts`: 自然言語解析ユーティリティ

### **自然言語処理**
- 正規表現ベースのパターンマッチング
- 意図解析（予約・相談・接続）
- データ抽出（日付・時間・治療内容）
- 信頼度スコアリング

### **統合ポイント**
- メインページ（`Index.tsx`）にチャットボットを配置
- 予約ページ（`Booking.tsx`）でAIデータを自動入力
- 既存の予約フローとの完全互換

## 📱 UI/UX特徴

### **チャットインターフェース**
- フローティングチャットボタン
- レスポンシブデザイン
- リアルタイムタイピング表示
- アクションボタン付きメッセージ

### **スタッフ選択**
- アバター表示
- オンライン状況の可視化
- 専門分野のバッジ表示
- 評価・対応時間の表示

### **アクションボタン**
- 📅 予約を確定する
- 📞 電話をかける
- 💬 チャットで接続
- 🕐 他の時間を確認

## 🔧 カスタマイズ可能な設定

### **AI応答のカスタマイズ**
```typescript
// AIChatBot.tsx内で応答テンプレートを編集
const aiResponse = generateResponse(intent, extractedData);
```

### **スタッフ情報の管理**
```typescript
// StaffConnectionDialog.tsx内でスタッフデータを編集
const staffMembers: StaffMember[] = [
  {
    id: '1',
    name: '田中 美咲',
    role: '受付スタッフ',
    status: 'online',
    specialties: ['予約管理', '一般相談'],
    rating: 4.8
  }
];
```

### **自然言語パターンの追加**
```typescript
// aiBookingParser.ts内で新しいパターンを追加
private static readonly TREATMENT_PATTERNS = [
  /(新しい治療名)/,  // 追加
  // 既存のパターン...
];
```

## 🚀 今後の拡張予定

### **高度なAI機能**
- OpenAI GPT APIとの統合
- より高精度な自然言語処理
- 多言語対応

### **通話機能**
- WebRTCによる音声通話
- ビデオ通話機能
- 通話録音・転写

### **高度なスタッフ機能**
- リアルタイム接続状況
- スタッフの専門分野マッチング
- 予約状況に基づく最適なスタッフ推薦

### **分析・レポート機能**
- チャットログの分析
- よくある質問の自動回答
- 患者満足度の追跡

## 📞 スタッフ接続機能の詳細

### **対応スタッフ**
1. **田中 美咲** - 受付スタッフ（予約管理、一般相談）
2. **佐藤 健太** - 歯科衛生士（治療相談、予防歯科）
3. **山田 花子** - 受付スタッフ（保険相談、治療費相談）
4. **鈴木 一郎** - 歯科医師（治療相談、診断、緊急対応）

### **接続方法**
- **チャット**: テキストベースの即座接続
- **電話**: 音声による直接相談

### **ステータス管理**
- **オンライン**: 即座に接続可能
- **対応中**: 他の患者対応中
- **オフライン**: 接続不可

## 🎉 実装完了

AIチャット機能が完全に実装され、以下のことが可能になりました：

✅ **自然言語での予約作成**
✅ **治療内容の相談**
✅ **スタッフとの接続**
✅ **電話転送機能**
✅ **既存システムとの完全統合**

患者は「12月25日14時に予約したい」と話すだけで、AIが自動的に予約フォームを入力し、スタッフとの接続も可能になりました！

## 🔗 関連ファイル

- `src/components/chat/AIChatBot.tsx` - メインチャットコンポーネント
- `src/components/chat/StaffConnectionDialog.tsx` - スタッフ接続ダイアログ
- `src/utils/aiBookingParser.ts` - 自然言語解析ユーティリティ
- `src/pages/Index.tsx` - メインページ（チャットボット統合）
- `src/pages/Booking.tsx` - 予約ページ（AIデータ自動入力）

